<div class="text-center mb-8">
    <h2 class="text-2xl font-semibold">
        Selecione o tipo de serviço de que necessita para continuar
    </h2>
    <p class="text-gray-900 dark:text-gray-400 mt-2">
        Escolha entre as nossas soluções Comercial ou Industrial, adaptadas às necessidades do seu negócio.
    </p>
</div>
<div class="grid grid-cols-12 gap-8 mb-10">
    <div class="col-span-6">
        <div class=" bg-gray-800 rounded-xl !p-4 cursor-pointer hover-scale" (click)="showDialog(comercial)">
            <div class="flex flex-col items-center justify-center h-full p-4">
                <i class="bi bi-cart3 text-emerald-400 mb-2" style="font-size: 3.5rem"></i>
                <span class="text-xl font-semibol text-surface-50">Comercial</span>
            </div>
        </div>
    </div>
    <div class="col-span-6">
        <div class="bg-gray-800 rounded-xl !p-4 cursor-pointer hover-scale" (click)="showDialog(industrial)">
            <div class="flex flex-col items-center justify-center h-full p-4">
                <i class="bi bi-building-gear text-emerald-400 mb-2" style="font-size: 3.5rem"></i>
                <span class="text-xl font-semibol text-surface-50">Industrial</span>
            </div>
        </div>
    </div>
</div>

<div class="flex flex-col md:flex-row items-start md:items-center justify-between mb-10">
    <div class="flex items-center mb-4 md:mb-0">
        <div class="bg-gray-800 p-3 rounded-xl mr-4">
            <span class="material-symbols-outlined "></span>
            <i class="bi bi-buildings text-emerald-400 text-3xl"></i>
        </div>
        <div>
            <h1 class="text-3xl font-bold">
                {{empresa.nome}}, {{empresa.sociedadeComercial.nome}}
            </h1>
        </div>
    </div>
    <div class="flex items-center space-x-3">
        <button routerLink="/empresa/{{empresa.utilizador.username}}"
            class="flex items-center justify-center bg-gray-700 hover:bg-gray-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-300 hover:cursor-pointer">
            <i class="bi bi-pencil mr-2"></i>
            Edit
        </button>
        <!-- <button
            class="flex items-center justify-center bg-gray-700 hover:bg-gray-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md transition duration-300 hover:cursor-pointer">
            <i class="bi bi-printer mr-2"></i>
            Print
        </button> -->
    </div>
</div>
<main>
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        <div class="lg:col-span-2">
            <section class="bg-gray-800 p-8 rounded-2xl shadow-lg mb-8">
                <div class="flex items-center mb-6">
                    <i class="bi bi-info-circle text-emerald-400 text-3xl mr-3"></i>
                    <h2 class="text-2xl font-semibold text-gray-200">Informações da Empresa</h2>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6">
                    <div>
                        <p class="text-sm text-gray-400 font-medium">Nome da Empresa</p>
                        <p class="text-lg text-gray-100">
                            {{empresa.nome}}
                        </p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-400 font-medium">Dimensão</p>
                        <p class="text-lg text-gray-100">
                            {{empresa.tipoEmpresa.replace('_',' ')}}
                        </p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-400 font-medium">Nº TIN (NIF)</p>
                        <p class="text-lg text-gray-100">
                            {{empresa.nif}}
                        </p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-400 font-medium">Nº Registo Comercial</p>
                        <p class="text-lg text-gray-100">
                            {{empresa.numeroRegistoComercial}}
                        </p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-400 font-medium">Data Registo</p>
                        <p class="text-lg text-gray-100">
                            {{empresa.dataRegisto | date: 'dd MMM yyyy'}}
                        </p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-400 font-medium">Sociedade Comercial</p>
                        <p class="text-lg text-gray-100">
                            {{empresa.sociedadeComercial.nome}}
                        </p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-400 font-medium">
                            Total Trabalhadores
                        </p>
                        <p class="text-lg text-gray-100">
                            {{empresa.totalTrabalhadores}}
                        </p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-400 font-medium">
                            Volume de Negócios Anual
                        </p>
                        <p class="text-lg text-gray-100">
                            {{empresa.volumeNegocioAnual | currency}}
                        </p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-400 font-medium">
                            Balanço total Anual
                        </p>
                        <p class="text-lg text-gray-100">
                            {{empresa.balancoTotalAnual |currency}}
                        </p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-400 font-medium">Endereço</p>
                        <p class="text-lg text-gray-100">
                            {{empresa.sede.local}} <br>
                            {{empresa.sede.aldeia.nome}},
                            {{empresa.sede.aldeia.suco.nome}},
                            {{empresa.sede.aldeia.suco.postoAdministrativo.nome}},
                            {{empresa.sede.aldeia.suco.postoAdministrativo.municipio.nome}}
                        </p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-400 font-medium">Longitude - Latitude</p>
                        <p class="text-lg text-gray-100">
                            <a [href]="'https://www.google.com/maps?q=' + empresa.latitude + ',' + empresa.longitude" 
                               target="_blank" 
                               class="text-emerald-400 hover:text-emerald-300 hover:underline cursor-pointer">
                                {{empresa.longitude}} - {{empresa.latitude}}
                            </a>
                        </p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-400 font-medium">Telefone/Telemóvel</p>
                        <p class="text-lg text-gray-100">
                            {{empresa.telefone}} / {{empresa.telemovel}}
                        </p>
                    </div>
                </div>
            </section>
            <section class="bg-gray-800 p-8 rounded-2xl shadow-lg mb-8">
                <div class="flex items-center mb-6">
                    <i class="bi bi-person-gear text-emerald-400 text-3xl mr-3"></i>
                    <h2 class="text-2xl font-semibold text-gray-200">Gerente</h2>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6">
                    <div>
                        <p class="text-sm text-gray-400 font-medium">Nome</p>
                        <p class="text-lg text-gray-100">
                            {{empresa.gerente.nome}}
                        </p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-400 font-medium">Telefone</p>
                        <p class="text-lg text-gray-100">
                            {{empresa.gerente.telefone}}
                        </p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-400 font-medium">Email</p>
                        <p class="text-lg text-gray-100">
                            {{empresa.gerente.email}}
                        </p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-400 font-medium">Documento de Identificaçåo</p>
                        <p class="text-lg text-gray-100">{{empresa.gerente.tipoDocumento.replace('_',' ')|titlecase}} –
                            {{empresa.gerente.numeroDocumento}}</p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-400 font-medium">Endereço</p>
                        <p class="text-lg text-gray-100">
                            {{empresa.gerente.morada.local}} <br>
                            {{empresa.gerente.morada.aldeia.nome}},
                            {{empresa.gerente.morada.aldeia.suco.nome}},
                            {{empresa.gerente.morada.aldeia.suco.postoAdministrativo.nome}},
                            {{empresa.gerente.morada.aldeia.suco.postoAdministrativo.municipio.nome}}
                        </p>
                    </div>
                </div>
            </section>
            <section class="bg-gray-800 p-8 rounded-2xl shadow-lg mb-8">
                <div class="flex items-center mb-6">
                    <i class="bi bi-person-badge text-emerald-400 text-3xl mr-3"></i>
                    <h2 class="text-2xl font-semibold text-gray-200">Representante</h2>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6">
                    <div>
                        <p class="text-sm text-gray-400 font-medium">Nome</p>
                        <p class="text-lg text-gray-100">
                            {{empresa.representante.nome}}
                        </p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-400 font-medium">Pai</p>
                        <p class="text-lg text-gray-100">
                            {{empresa.representante.pai}}
                        </p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-400 font-medium">Mãe</p>
                        <p class="text-lg text-gray-100">
                            {{empresa.representante.mae}}
                        </p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-400 font-medium">Data de Nascimento</p>
                        <p class="text-lg text-gray-100">
                            {{empresa.representante.dataNascimento | date: 'dd MMM yyyy'}}
                        </p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-400 font-medium">Estado Civil</p>
                        <p class="text-lg text-gray-100">
                            {{empresa.representante.estadoCivil}}
                        </p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-400 font-medium">Nacionalidade</p>
                        <p class="text-lg text-gray-100">
                            {{empresa.representante.nacionalidade}}
                        </p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-400 font-medium">Naturalidade</p>
                        <p class="text-lg text-gray-100">
                            {{empresa.representante.naturalidade}}
                        </p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-400 font-medium">Telefone</p>
                        <p class="text-lg text-gray-100">
                            {{empresa.representante.telefone}}
                        </p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-400 font-medium">Email</p>
                        <p class="text-lg text-gray-100">
                            {{empresa.representante.email}}
                        </p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-400 font-medium">Documento de Identificaçåo</p>
                        <p class="text-lg text-gray-100">
                            {{empresa.representante.tipoDocumento.replace('_',' ')|titlecase}} –
                            {{empresa.representante.numeroDocumento}}</p>
                    </div>
                    <div>
                        <p class="text-sm text-gray-400 font-medium">Endereço</p>
                        <p class="text-lg text-gray-100">
                            {{empresa.representante.morada.local}} <br>
                            {{empresa.representante.morada.aldeia.nome}},
                            {{empresa.representante.morada.aldeia.suco.nome}},
                            {{empresa.representante.morada.aldeia.suco.postoAdministrativo.nome}},
                            {{empresa.representante.morada.aldeia.suco.postoAdministrativo.municipio.nome}}
                        </p>
                    </div>
                </div>
            </section>
            <section class="bg-gray-800 p-8 rounded-2xl shadow-lg">
                <div class="flex items-center mb-6">
                    <i class="bi bi-people text-emerald-400 text-3xl mr-3"></i>
                    <h2 class="text-2xl font-semibold text-gray-200">Acionista(s)</h2>
                </div>
                <div>
                    @for (item of empresa.acionistas; track $index) {
                    <div class="border-b border-gray-700 pb-6 mb-6">
                        <h3 class="text-xl font-semibold text-gray-300 mb-4">
                            {{item.nome}}
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6">
                            <div>
                                <p class="text-sm text-gray-400 font-medium">Nª TIN (NIF)</p>
                                <p class="text-lg text-gray-100">
                                    {{item.nif}}
                                </p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-400 font-medium">Documento de Identificaçåo</p>
                                <p class="text-lg text-gray-100">{{item.tipoDocumento.replace('_',' ')|titlecase}} –
                                    {{item.numeroDocumento}}</p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-400 font-medium">Ações</p>
                                <p class="text-lg text-gray-100">
                                    {{item.acoes}} %
                                </p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-400 font-medium">Email</p>
                                <p class="text-lg text-gray-100">
                                    {{item.email}}
                                </p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-400 font-medium">
                                    Agregado Família
                                </p>
                                <p class="text-lg text-gray-100">
                                    {{item.agregadoFamilia}}
                                </p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-400 font-medium">
                                    Relação Família
                                </p>
                                <p class="text-lg text-gray-100">
                                    {{item.relacaoFamilia}}
                                </p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-400 font-medium">Endereço</p>
                                <p class="text-lg text-gray-100">
                                    {{item.endereco.local}} <br>
                                    {{item.endereco.aldeia.nome}},
                                    {{item.endereco.aldeia.suco.nome}},
                                    {{item.endereco.aldeia.suco.postoAdministrativo.nome}},
                                    {{item.endereco.aldeia.suco.postoAdministrativo.municipio.nome}}
                                </p>
                            </div>
                        </div>
                    </div>
                    }
                </div>
            </section>
        </div>
        <div class="lg:col-span-1 space-y-8">
            <section class="bg-gray-800 p-8 rounded-2xl shadow-lg">
                <div class="flex items-center mb-6">
                    <i class="bi bi-bank text-emerald-400 text-3xl mr-3"></i>
                    <h2 class="text-2xl font-semibold text-gray-200">
                        Capital Social
                    </h2>
                </div>
                <div class="space-y-4">
                    <div>
                        <p class="text-2xl font-bold text-white">
                            {{empresa.capitalSocial | currency}}
                        </p>
                    </div>
                </div>
            </section>
            <section class="bg-gray-800 p-8 rounded-2xl shadow-lg">
                <div class="flex items-center mb-6">
                    <i class="bi bi-folder2-open text-emerald-400 text-3xl mr-3"></i>
                    <h2 class="text-2xl font-semibold text-gray-200">Documentos</h2>
                </div>
                <ul class="space-y-3">
                    @for (doc of empresa.documentos; track $index) {
                    <li class="flex items-center justify-between bg-gray-700/50 p-3 rounded-lg">
                        <div class="flex items-center">
                            <i class="bi bi-file-text text-gray-400 mr-3"></i>
                            <span class="text-gray-200">
                                {{doc.nome}}
                            </span>
                        </div>
                        <p-button class="text-emerald-400 hover:text-emerald-300" (click)="downloadDoc(doc)"
                            [loading]="loadingDownloadButtons.has(doc.nome)" icon="pi pi-download" [rounded]="true"
                            [text]="true" severity="success" />
                    </li>
                    }
                </ul>
            </section>
        </div>
    </div>
</main>
<p-toast position="bottom-center" />
<p-dialog header="Criar Aplicante" [modal]="true" [position]="'top'" [(visible)]="visible" [style]="{ width: '45rem' }">
    <div class="card">
        <div class="grid grid-cols-12 gap-8 md:gap-4">
            <div class="col-span-12">
                <p class="m-0 p-0 leading-normal mr-4">Forneça as informações
                    necessárias abaixo para configurar uma nova inscrição.</p>
            </div>

            <div class="col-span-12">
                <form [formGroup]="applicationForm">
                    <div class="grid grid-cols-12 gap-4">
                        <div class="mb-6 col-span-12">
                            <label for="tipo" class="font-medium mb-2 block">
                                Tipo Aplicante
                            </label>
                            <p-select formControlName="tipo" inputId="tipo" [options]="applicationTypes"
                                optionLabel="name" fluid [showClear]="true" placeholder="Selecione um tipo">
                            </p-select>
                        </div>
                    </div>
                    <button (click)="create(applicationForm)" icon="pi pi-plus" [loading]="loading"
                        [disabled]="!applicationForm.valid" pButton pRipple label="Criar Aplicante"
                        class="w-auto mt-3 mr-4"></button>
                    <p-button label="Cancelar" severity="secondary" icon="pi pi-times" iconPos="left"
                        (click)="visible = false" />
                </form>
            </div>
        </div>
    </div>
</p-dialog>